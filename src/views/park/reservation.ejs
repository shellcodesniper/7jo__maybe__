<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Capstone 7Jo</title>

	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" />

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="/static/css/reservation.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

</head>

<% const { name, address, cost } = park %>
<% const { username, phoneNumber, carNumber } = user; %>
<body>
	<div id="booking" class="section">
		<div class="section-center">
			<div class="container">
				<div class="row">
					<div class="booking-form">
						<form action = "" method="POST">
							<div class="form-group">
								<span class="form-label">주차장 이름</span>
								<input class="form-control" type="text" value="<%= name %>"readonly>
							</div>
							<div class="form-group">
								<span class="form-label">주차장 주소</span>
								<input class="form-control" type="text" value="<%= address %>"readonly>
							</div>
							<div class="form-group">
								<span class="form-label">시간당 가격</span>
								<input class="form-control" type="number" value="<%= cost %>"readonly>
							</div>
							<div class="row no-margin">
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">시작</span>
										<input class="form-control" name="startTime" type="time" required>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<span class="form-label">끝</span>
										<input class="form-control" name="endTime" type="time" required>
									</div>
								</div>
							</div>
							<div class="form-group">
                  <span class="form-label">이름</span>
                  <input class="form-control" name="realName" type="name" placeholder="이름을 입력해주시기 바랍니다." value="">
							</div>
              <div class="form-group">
								<span class="form-label">전화번호</span>
								<input class="form-control" type="tel" placeholder="010-1234-5678" value="<%= phoneNumber %>" readonly>
							</div>
							<div class="form-group">
								<span class="form-label">차량번호</span>
								<input class="form-control" type="car" placeholder="12가3456" value="<%= carNumber %>" readOnly>
							</div>
							<div class="form-btn">
                                <div class="form-group">
								<span class="form-label">사용시간</span>
								<select id="useHour" class="form-control" required>
									<option value="" selected hidden> == 사용시간을 선택해주시기 바랍니다. ==</option>
                  <% for (var i = 30; i <= 60*72; i+= 30) {
                    const hour = Math.floor(i / 60);
                    const min = i % 60;
                    %>
                    <% if (i < 24 * 2 * 30) { %>
                      <option value="<%= i %>"><%= hour > 0 ? `${hour}시간 ` : '' %><%= min > 0 ? `${min}분`: ''%></option>
                    <% } else if(i % 60 === 0) { %>
                      <option value="<%= i %>"><%= hour %>시간 </option>
                    <% } %>
                  <% } %>
								</select>
								<span class="select-arrow"></span>
							</div>
              <div class="form-group">
								<span class="form-label">예상가격</span>
								<input id="predictCost" class="form-control" type="text" placeholder="0" value = "">
							</div>
								<button class="submit-btn">예약</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $('#useHour').on('change', function() {
        const baseCost = parseInt('<%= cost %>', 10);
        const factor = this.value / 60;
        const expectPrice = Math.floor(baseCost * factor)
        const price = `￦ ${expectPrice.toLocaleString('ko-KR')}`;
        $('#predictCost').val(price);
      });
    });
  </script>
</body>

</html>